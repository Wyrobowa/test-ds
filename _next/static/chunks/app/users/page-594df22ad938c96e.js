(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9],{3511:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=e=>String(e).charAt(0).toUpperCase()+String(e).slice(1)},4981:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var s=a(5155),i=a(9749),n=a(8223);function r(e){let t,a,r,d,c,u,m,h,f,j,p,x,g,_,y=(0,i.c)(55),{form:b,setForm:v,roles:w,statuses:C}=e;if(y[0]!==b||y[1]!==w||y[2]!==v||y[3]!==C){let e,i,g,_,S,E=w.map(o),k=C.map(l);a=n.az,h="flex",f="column",j=4,y[16]!==b||y[17]!==v?(e=e=>v({...b,name:e.target.value}),y[16]=b,y[17]=v,y[18]=e):e=y[18],y[19]!==b.name||y[20]!==e?(p=(0,s.jsx)(n.pd,{label:"Name",placeholder:"Enter name",value:b.name,onChange:e,required:!0}),y[19]=b.name,y[20]=e,y[21]=p):p=y[21],y[22]!==b||y[23]!==v?(i=e=>v({...b,email:e.target.value}),y[22]=b,y[23]=v,y[24]=i):i=y[24],y[25]!==b.email||y[26]!==i?(x=(0,s.jsx)(n.pd,{label:"Email",placeholder:"Enter email",type:"email",value:b.email,onChange:i,required:!0}),y[25]=b.email,y[26]=i,y[27]=x):x=y[27],y[28]!==b||y[29]!==v?(g=e=>v({...b,role_id:""===e.target.value?"":Number(e.target.value)}),y[28]=b,y[29]=v,y[30]=g):g=y[30],y[31]===Symbol.for("react.memo_cache_sentinel")?(_={value:"",label:"Select role"},y[31]=_):_=y[31];let A=[_,...E];y[32]!==b.role_id||y[33]!==g||y[34]!==A?(d=(0,s.jsx)(n.l6,{label:"Role",value:b.role_id,onChange:g,options:A,required:!0}),y[32]=b.role_id,y[33]=g,y[34]=A,y[35]=d):d=y[35],t=n.l6,r="Status",c=b.status_id,y[36]!==b||y[37]!==v?(u=e=>v({...b,status_id:""===e.target.value?"":Number(e.target.value)}),y[36]=b,y[37]=v,y[38]=u):u=y[38],y[39]===Symbol.for("react.memo_cache_sentinel")?(S={value:"",label:"Select status"},y[39]=S):S=y[39],m=[S,...k],y[0]=b,y[1]=w,y[2]=v,y[3]=C,y[4]=t,y[5]=a,y[6]=r,y[7]=d,y[8]=c,y[9]=u,y[10]=m,y[11]=h,y[12]=f,y[13]=j,y[14]=p,y[15]=x}else t=y[4],a=y[5],r=y[6],d=y[7],c=y[8],u=y[9],m=y[10],h=y[11],f=y[12],j=y[13],p=y[14],x=y[15];return y[40]!==t||y[41]!==r||y[42]!==c||y[43]!==u||y[44]!==m?(g=(0,s.jsx)(t,{label:r,value:c,onChange:u,options:m,required:!0}),y[40]=t,y[41]=r,y[42]=c,y[43]=u,y[44]=m,y[45]=g):g=y[45],y[46]!==a||y[47]!==d||y[48]!==g||y[49]!==h||y[50]!==f||y[51]!==j||y[52]!==p||y[53]!==x?(_=(0,s.jsxs)(a,{display:h,flexDirection:f,gap:j,children:[p,x,d,g]}),y[46]=a,y[47]=d,y[48]=g,y[49]=h,y[50]=f,y[51]=j,y[52]=p,y[53]=x,y[54]=_):_=y[54],_}function l(e){return{value:e.id,label:e.name}}function o(e){return{value:e.id,label:e.name}}function d(e){let t,a,l,o,d,c=(0,i.c)(22),{isOpen:u,onClose:m,title:h,form:f,setForm:j,roles:p,statuses:x,onSubmit:g,submitLabel:_,isLoading:y}=e;c[0]!==y||c[1]!==m?(t=(0,s.jsx)(n.$n,{variant:"outline",onClick:m,disabled:y,children:"Cancel"}),c[0]=y,c[1]=m,c[2]=t):t=c[2];let b=y?"Saving...":_;return c[3]!==y||c[4]!==g||c[5]!==b?(a=(0,s.jsx)(n.$n,{variant:"solid",intent:"info",onClick:g,disabled:y,children:b}),c[3]=y,c[4]=g,c[5]=b,c[6]=a):a=c[6],c[7]!==t||c[8]!==a?(l=(0,s.jsxs)(n.az,{display:"flex",gap:4,justifyContent:"flex-end",children:[t,a]}),c[7]=t,c[8]=a,c[9]=l):l=c[9],c[10]!==f||c[11]!==p||c[12]!==j||c[13]!==x?(o=(0,s.jsx)(r,{form:f,setForm:j,roles:p,statuses:x}),c[10]=f,c[11]=p,c[12]=j,c[13]=x,c[14]=o):o=c[14],c[15]!==y||c[16]!==u||c[17]!==m||c[18]!==l||c[19]!==o||c[20]!==h?(d=(0,s.jsx)(n.aF,{isOpen:u,onClose:m,title:h,size:"md",isLoading:y,footer:l,children:o}),c[15]=y,c[16]=u,c[17]=m,c[18]=l,c[19]=o,c[20]=h,c[21]=d):d=c[21],d}var c=a(9378),u=a(3511);function m(e){let t,a,r,l=(0,i.c)(9),{users:o,isLoading:d,onEdit:m,onDelete:h}=e;return l[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,s.jsx)(n.A0,{children:(0,s.jsxs)(n.Hj,{children:[(0,s.jsx)(n.nd,{children:"Name"}),(0,s.jsx)(n.nd,{children:"Email"}),(0,s.jsx)(n.nd,{children:"Role"}),(0,s.jsx)(n.nd,{children:"Status"}),(0,s.jsx)(n.nd,{children:"Actions"})]})}),l[0]=t):t=l[0],l[1]!==d||l[2]!==h||l[3]!==m||l[4]!==o?(a=(0,s.jsx)(n.BF,{children:d?(0,s.jsx)(n.Hj,{children:(0,s.jsx)(n.nA,{colSpan:5,align:"center",children:(0,s.jsx)(n.az,{padding:12,children:(0,s.jsx)(n.aH,{size:"lg"})})})}):(0,s.jsx)(s.Fragment,{children:o.map(e=>(0,s.jsxs)(n.Hj,{children:[(0,s.jsx)(n.nA,{children:(0,s.jsx)(n.EY,{weight:"bold",children:e.name})}),(0,s.jsx)(n.nA,{children:e.email}),(0,s.jsx)(n.nA,{children:(0,u.Z)(e.role||"")}),(0,s.jsx)(n.nA,{children:(0,s.jsx)(n.Ex,{intent:(0,c.w)(e.status),variant:"subtle",children:(0,u.Z)(e.status)})}),(0,s.jsx)(n.nA,{children:(0,s.jsxs)(n.az,{display:"flex",gap:2,children:[(0,s.jsx)(n.$n,{size:"sm",variant:"outline",intent:"neutral",onClick:()=>m(e),children:"Edit"}),"removed"!==e.status?(0,s.jsx)(n.$n,{size:"sm",variant:"outline",intent:"danger",onClick:()=>h(e.id),children:"Delete"}):null]})})]},e.id))})}),l[1]=d,l[2]=h,l[3]=m,l[4]=o,l[5]=a):a=l[5],l[6]!==d||l[7]!==a?(r=(0,s.jsxs)(n.XI,{hoverable:!0,striped:!0,isLoading:d,children:[t,a]}),l[6]=d,l[7]=a,l[8]=r):r=l[8],r}var h=a(2115),f=a(9406);function j(){let e,t,a,r,l,o,c=(0,i.c)(32),{roles:u,statuses:j,users:p,isLoading:x,isAddModalOpen:g,isEditModalOpen:_,form:y,setForm:b,handleAddUser:v,handleEditUser:w,handleDeleteUser:C,openAddModal:S,openEditModal:E,closeAddModal:k,closeEditModal:A}=function(){let[e,t]=(0,h.useState)([]),[a,s]=(0,h.useState)([]),[i,n]=(0,h.useState)([]),[r,l]=(0,h.useState)(!1),[o,d]=(0,h.useState)(!1),[c,u]=(0,h.useState)(!1),[m,j]=(0,h.useState)(null),p=(0,h.useMemo)(()=>({name:"",email:"",role_id:"",status_id:""}),[]),[x,g]=(0,h.useState)(p),_=async()=>{l(!0);try{n(await (0,f.Vg)("/api/users"))}catch(e){console.error(e)}finally{l(!1)}},y=async()=>{l(!0);try{await (0,f.$P)("/api/users",{name:x.name.trim(),email:x.email.trim(),role_id:""===x.role_id?null:x.role_id,status_id:""===x.status_id?null:x.status_id}),await _(),d(!1),g(p)}catch(e){alert(e instanceof Error?e.message:"Failed to add user")}finally{l(!1)}},b=async()=>{if(m){l(!0);try{await (0,f.$Y)("/api/users",{id:m.id,name:x.name.trim(),email:x.email.trim(),role_id:""===x.role_id?null:x.role_id,status_id:""===x.status_id?null:x.status_id}),await _(),u(!1),j(null),g(p)}catch(e){alert(e instanceof Error?e.message:"Failed to update user")}finally{l(!1)}}},v=async e=>{if(confirm("Are you sure you want to delete this user?")){l(!0);try{await (0,f.$Y)("/api/users",{id:e,status_id:3}),await _()}catch(e){alert(e instanceof Error?e.message:"Failed to remove user")}finally{l(!1)}}},w=(0,h.useCallback)(()=>{g(p),d(!0)},[p,g,d]),C=(0,h.useCallback)(e=>{j(e),g({name:e.name,email:e.email,role_id:e.role_id||"",status_id:e.status_id||""}),u(!0)},[j,g,u]),S=(0,h.useCallback)(()=>d(!1),[d]),E=(0,h.useCallback)(()=>u(!1),[u]);return(0,h.useEffect)(()=>{(async()=>{l(!0);try{let[e,a,i]=await Promise.all([(0,f.Vg)("/api/roles"),(0,f.Vg)("/api/statuses"),(0,f.Vg)("/api/users")]);t(e),s(a),n(i)}catch(e){console.error(e)}finally{l(!1)}})()},[]),{roles:e,statuses:a,users:i,isLoading:r,isAddModalOpen:o,isEditModalOpen:c,form:x,setForm:g,handleAddUser:y,handleEditUser:b,handleDeleteUser:v,openAddModal:w,openEditModal:C,closeAddModal:S,closeEditModal:E}}();return c[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsx)(n.az,{display:"flex",alignItems:"center",gap:4,children:(0,s.jsx)(n.EY,{variant:"h1",weight:"bold",children:"Users Directory"})}),c[0]=e):e=c[0],c[1]!==x||c[2]!==S?(t=(0,s.jsxs)(n.az,{display:"flex",justifyContent:"space-between",alignItems:"center",paddingBottom:8,children:[e,(0,s.jsx)(n.$n,{variant:"solid",intent:"info",onClick:S,disabled:x,children:"Add New User"})]}),c[1]=x,c[2]=S,c[3]=t):t=c[3],c[4]!==C||c[5]!==x||c[6]!==E||c[7]!==p?(a=(0,s.jsx)(m,{users:p,isLoading:x,onEdit:E,onDelete:C}),c[4]=C,c[5]=x,c[6]=E,c[7]=p,c[8]=a):a=c[8],c[9]!==k||c[10]!==y||c[11]!==v||c[12]!==g||c[13]!==x||c[14]!==u||c[15]!==b||c[16]!==j?(r=(0,s.jsx)(d,{isOpen:g,onClose:k,title:"Add User",form:y,setForm:b,roles:u,statuses:j,onSubmit:v,submitLabel:"Confirm",isLoading:x}),c[9]=k,c[10]=y,c[11]=v,c[12]=g,c[13]=x,c[14]=u,c[15]=b,c[16]=j,c[17]=r):r=c[17],c[18]!==A||c[19]!==y||c[20]!==w||c[21]!==_||c[22]!==x||c[23]!==u||c[24]!==b||c[25]!==j?(l=(0,s.jsx)(d,{isOpen:_,onClose:A,title:"Update Profile",form:y,setForm:b,roles:u,statuses:j,onSubmit:w,submitLabel:"Confirm",isLoading:x}),c[18]=A,c[19]=y,c[20]=w,c[21]=_,c[22]=x,c[23]=u,c[24]=b,c[25]=j,c[26]=l):l=c[26],c[27]!==t||c[28]!==a||c[29]!==r||c[30]!==l?(o=(0,s.jsxs)(n.az,{paddingY:8,children:[t,a,r,l]}),c[27]=t,c[28]=a,c[29]=r,c[30]=l,c[31]=o):o=c[31],o}},5684:(e,t,a)=>{Promise.resolve().then(a.bind(a,4981))},9378:(e,t,a)=>{"use strict";a.d(t,{w:()=>s});let s=e=>{switch(e){case"active":return"success";case"suspended":return"warning";case"removed":return"danger";default:return"neutral"}}},9406:(e,t,a)=>{"use strict";a.d(t,{$P:()=>r,$Y:()=>o,Al:()=>l,Vg:()=>n});let s=(a(2402).env.NEXT_PUBLIC_API_BASE_URL||"").replace(/\/$/,"");function i(e){return/^https?:\/\//i.test(e)||!s?e:`${s}${e.startsWith("/")?"":"/"}${e}`}async function n(e){let t=await fetch(i(e));if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e?.message||e?.error||"Request failed")}return t.json()}async function r(e,t){let a=await fetch(i(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e?.message||e?.error||"Request failed")}return a.json()}async function l(e){let t=await fetch(i(e),{method:"DELETE"});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e?.message||e?.error||"Request failed")}return 204===t.status?{}:t.json()}async function o(e,t){let a=await fetch(i(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e?.message||e?.error||"Request failed")}return a.json()}}},e=>{e.O(0,[915,441,826,358],()=>e(e.s=5684)),_N_E=e.O()}]);